1. List of tables with their columns, data types, and constraints
**Enum Types**
feed_update_unit enum: hour, day, week; used by Feeds.UpdateIntervalUnit.
feed_analysis_status enum: pending, completed, failed, superseded; used by FeedAnalyses.AnalysisStatus.
feed_preflight_checks: C# [Flags] enum with values None=0, RequiresJavascript=1, RequiresAuthentication=2, Paywalled=4, InvalidMarkup=8, RateLimited=16, UnknownIssue=32; stored as integer in FeedAnalyses.PreflightChecks. This allows multiple flags to be set simultaneously using bitwise operations.
feed_parse_status enum: scheduled, running, succeeded, failed, skipped; used by FeedParseRuns.Status.
feed_parse_item_change enum: new, refreshed, unchanged; used by FeedParseRunItems.ChangeKind.

**AspNetUsers** (ASP.NET Identity defaults retained; GUID primary key)
| Column | Type | Constraints |
| --- | --- | --- |
| Id | uuid | Primary key; value supplied by Identity (GUID) |
| UserName, NormalizedUserName | nvarchar(256) | Unique on NormalizedUserName |
| Email, NormalizedEmail | nvarchar(256) | Index on NormalizedEmail |
| ConcurrencyStamp, SecurityStamp, PasswordHash, etc. | various | Standard Identity columns |

**FeedAnalyses** (table name: FeedAnalyses)
| Column | Type | Constraints |
| --- | --- | --- |
| Id | uuid | Primary key; UUIDv7 generated by application |
| UserId | uuid | Not null; FK to AspNetUsers(Id) on delete cascade |
| TargetUrl | text | Not null |
| NormalizedUrl | text | Not null; invariant lower-case canonical form |
| AnalysisStatus | feed_analysis_status | Not null; default 'pending' |
| PreflightChecks | int | Not null; stores C# flags enum |
| PreflightDetails | jsonb | Not null; strongly-typed as FeedPreflightDetails model |
| Selectors | jsonb | Nullable; strongly-typed as FeedSelectors model |
| Warnings | text[] | Not null; PostgreSQL native text array |
| AiModel | text | Nullable |
| ApprovedFeedId | uuid | Nullable; FK to Feeds(Id) on delete set null |
| AnalysisStartedAt | timestamptz | Nullable |
| AnalysisCompletedAt | timestamptz | Nullable |
| CreatedAt | timestamptz | Not null; default now() |
| UpdatedAt | timestamptz | Not null; managed by UpdateTimestampsInterceptor |

**Feeds** (table name: Feeds)
| Column | Type | Constraints |
| --- | --- | --- |
| Id | uuid | Primary key; UUIDv7 generated by application; used in public feed URLs /feed/{userId}/{Id} |
| UserId | uuid | Not null; FK to AspNetUsers(Id) on delete cascade |
| SourceUrl | text | Not null |
| NormalizedSourceUrl | text | Not null |
| Title | varchar(200) | Not null |
| Description | varchar(2000) | Nullable |
| Language | varchar(16) | Nullable; ISO-639-1/2 code |
| Selectors | jsonb | Not null; strongly-typed as FeedSelectors model |
| UpdateIntervalUnit | feed_update_unit | Not null |
| UpdateIntervalValue | smallint | Not null; check (UpdateIntervalValue >= 1) |
| TtlMinutes | smallint | Not null; default 60; check (TtlMinutes >= 15) |
| Etag | text | Nullable |
| LastModified | timestamptz | Nullable |
| LastParsedAt | timestamptz | Nullable |
| NextParseAfter | timestamptz | Nullable |
| LastParseStatus | feed_parse_status | Nullable |
| AnalysisId | uuid | Nullable; FK to FeedAnalyses(Id) on delete set null |
| CreatedAt | timestamptz | Not null; default now() |
| UpdatedAt | timestamptz | Not null; managed by UpdateTimestampsInterceptor |

**FeedParseRuns** (table name: FeedParseRuns)
| Column | Type | Constraints |
| --- | --- | --- |
| Id | uuid | Primary key; UUIDv7 generated by application |
| FeedId | uuid | Not null; FK to Feeds(Id) on delete cascade |
| StartedAt | timestamptz | Not null |
| CompletedAt | timestamptz | Nullable |
| Status | feed_parse_status | Not null |
| FailureReason | text | Nullable; concise failure summary |
| HttpStatusCode | smallint | Nullable |
| ResponseHeaders | jsonb | Not null; strongly-typed as HttpResponseHeaders model |
| FetchedItemsCount | integer | Not null; default 0 |
| NewItemsCount | integer | Not null; default 0 |
| UpdatedItemsCount | integer | Not null; default 0 |
| SkippedItemsCount | integer | Not null; default 0 |
| CreatedAt | timestamptz | Not null; default now() |

**FeedItems** (table name: FeedItems)
| Column | Type | Constraints |
| --- | --- | --- |
| Id | uuid | Primary key; UUIDv7 generated by application |
| FeedId | uuid | Not null; FK to Feeds(Id) on delete cascade |
| Fingerprint | char(64) | Not null |
| SourceUrl | varchar(2048) | Not null |
| NormalizedSourceUrl | varchar(2048) | Not null |
| Title | varchar(512) | Not null |
| Summary | varchar(2048) | Nullable |
| PublishedAt | timestamptz | Nullable |
| DiscoveredAt | timestamptz | Not null; default now() |
| LastSeenAt | timestamptz | Not null; default now() |
| FirstParseRunId | uuid | Nullable; FK to FeedParseRuns(Id) on delete set null |
| LastParseRunId | uuid | Nullable; FK to FeedParseRuns(Id) on delete set null |
| RawMetadata | jsonb | Not null; strongly-typed as FeedItemMetadata model |
| CreatedAt | timestamptz | Not null; default now() |
| UpdatedAt | timestamptz | Not null; managed by UpdateTimestampsInterceptor |

**FeedParseRunItems** (table name: FeedParseRunItems)
| Column | Type | Constraints |
| --- | --- | --- |
| FeedParseRunId | uuid | Not null; FK to FeedParseRuns(Id) on delete cascade |
| FeedItemId | uuid | Not null; FK to FeedItems(Id) on delete cascade |
| ChangeKind | feed_parse_item_change | Not null |
| SeenAt | timestamptz | Not null; default now() |
Primary key (FeedParseRunId, FeedItemId).

2. Relationships between tables
- AspNetUsers 1:N Feeds (ownership of feeds).
- AspNetUsers 1:N FeedAnalyses (draft analyses per user).
- FeedAnalyses (approved) 1:1 Feeds via Feeds.AnalysisId and FeedAnalyses.ApprovedFeedId.
- Feeds 1:N FeedParseRuns.
- Feeds 1:N FeedItems.
- FeedParseRuns N:M FeedItems via FeedParseRunItems capturing items processed per run.
- FeedParseRuns (discovery) 1:N FeedParseRunItems for created/updated membership records.

3. Indexes
- FeedAnalyses unique index on (UserId, NormalizedUrl) to block duplicate analyses per target.
- FeedAnalyses btree index on (AnalysisStatus, CreatedAt desc) for workflow dashboards.
- Feeds unique index on (UserId, NormalizedSourceUrl) to prevent duplicate feeds on same site per user.
- Feeds btree index on (NextParseAfter, LastParseStatus) to schedule background worker polling.
- FeedParseRuns btree index on (FeedId, StartedAt desc) for recent history queries.
- FeedParseRuns partial index on (Status) where Status = 'failed' for failure triage.
- FeedItems unique index on (FeedId, NormalizedSourceUrl).
- FeedItems unique index on (FeedId, Fingerprint).
- FeedItems btree index on (FeedId, PublishedAt desc) for RSS ordering.
- FeedItems btree index on (FeedId, LastSeenAt desc) to detect stale items.
- FeedParseRunItems btree index on (FeedItemId, SeenAt desc) to quickly locate latest run associations.
- FeedParseRunItems btree index on (FeedParseRunId, ChangeKind) to summarize run outcomes.

4. Additional notes or explanations about design decisions
- **Naming Conventions**: Tables and columns use PascalCase following EF Core conventions. PostgreSQL treats unquoted identifiers as case-insensitive and lowercases them, making PascalCase the standard .NET convention that works seamlessly.
- **UUIDv7 Generation**: UUIDv7 values are generated by the application layer to preserve temporal ordering while staying globally unique; columns omit database defaults intentionally.
- **Normalized URLs**: Normalized URL columns store canonicalized forms (lower-case host, trimmed paths, stripped fragments); application enforces normalization before persistence to keep unique constraints effective.
- **UpdatedAt Management**: UpdatedAt timestamps are managed via UpdateTimestampsInterceptor which automatically sets the value to UtcNow for all entities implementing IAuditableEntity during SaveChanges.
- **ASP.NET Identity**: Standard ASP.NET Identity tables (AspNetRoles, AspNetUserRoles, AspNetUserClaims, etc.) use default EF Core naming and are omitted from detail; only AspNetUsers is referenced directly.
- **Type-Safe JSON**: All JSONB columns use strongly-typed C# models (FeedSelectors, FeedPreflightDetails, HttpResponseHeaders, FeedItemMetadata) configured with EF Core's OwnsOne/OwnsMany().ToJson() for compile-time safety and IntelliSense support.
- **Warnings Array**: Uses PostgreSQL native text[] array type instead of JSONB for better performance with simple string collections and native array operations.
- **Preflight Checks**: Stored as integer representing C# [Flags] enum for efficient bitwise operations when checking multiple conditions.
- **TtlMinutes**: Enforces RSS TTL requirement (default 60) yet allows per-feed overrides within reasonable bounds via check constraint.
- **Feed URLs**: Public RSS feed URLs use pattern /feed/{userId}/{feedId} where feedId is the primary key, eliminating need for separate public_id column.
