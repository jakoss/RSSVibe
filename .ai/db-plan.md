1. List of tables with their columns, data types, and constraints
**Enum Types**
feed_update_unit enum: hour, day, week; used by feeds.update_interval_unit.
feed_analysis_status enum: pending, completed, failed, superseded; used by feed_analysis.analysis_status.
feed_preflight_flag enum: requires_javascript, requires_authentication, paywalled, invalid_markup, rate_limited, unknown_issue; stored as int feed_preflight_flag and mapped into C# enum flags pattern.
feed_parse_status enum: scheduled, running, succeeded, failed, skipped; used by feed_parse_run.status.
feed_parse_item_change enum: new, refreshed, unchanged; used by feed_parse_run_items.change_kind.

**AspNetUsers** (ASP.NET Identity defaults retained; GUID primary key)
| Column | Type | Constraints |
| --- | --- | --- |
| Id | uuid | Primary key; value supplied by Identity (GUID) |
| UserName, NormalizedUserName | nvarchar(256) | Unique on NormalizedUserName |
| Email, NormalizedEmail | nvarchar(256) | Index on NormalizedEmail |
| ConcurrencyStamp, SecurityStamp, PasswordHash, etc. | various | Standard Identity columns |

**feed_analysis**
| Column | Type | Constraints |
| --- | --- | --- |
| id | uuid | Primary key; UUIDv7 generated by application |
| user_id | uuid | Not null; FK to AspNetUsers(Id) on delete cascade |
| target_url | text | Not null |
| normalized_url | text | Not null; invariant lower-case canonical form |
| analysis_status | feed_analysis_status | Not null; default pending |
| preflight_flags | int | Not null; default 0 |
| preflight_details | jsonb | Not null; default '{}' |
| selectors | jsonb | Nullable until AI completes; stores list/item/title/link/pubDate selectors |
| warnings | jsonb | Not null; default '[]' |
| ai_model | text | Nullable |
| approved_feed_id | uuid | Nullable; FK to feed(id) on delete set null |
| analysis_started_at | timestamptz | Nullable |
| analysis_completed_at | timestamptz | Nullable |
| created_at | timestamptz | Not null; default now() |
| updated_at | timestamptz | Not null; default now() |

**feed**
| Column | Type | Constraints |
| --- | --- | --- |
| id | uuid | Primary key; UUIDv7 generated by application |
| user_id | uuid | Not null; FK to AspNetUsers(Id) on delete cascade |
| source_url | text | Not null |
| normalized_source_url | text | Not null |
| title | varchar(200) | Not null |
| description | varchar(2000) | Nullable |
| language | varchar(16) | Nullable; ISO-639-1/2 code |
| selectors | jsonb | Not null; approved selector set |
| update_interval_unit | feed_update_unit | Not null |
| update_interval_value | smallint | Not null; check (update_interval_value >= 1) |
| ttl_minutes | smallint | Not null; default 60; check (ttl_minutes >= 15) |
| etag | text | Nullable |
| last_modified | timestamptz | Nullable |
| last_parsed_at | timestamptz | Nullable |
| next_parse_after | timestamptz | Nullable |
| last_parse_status | feed_parse_status | Nullable |
| analysis_id | uuid | Nullable; FK to feed_analysis(id) on delete set null |
| created_at | timestamptz | Not null; default now() |
| updated_at | timestamptz | Not null; default now() |

**feed_parse_run**
| Column | Type | Constraints |
| --- | --- | --- |
| id | uuid | Primary key; UUIDv7 generated by application |
| feed_id | uuid | Not null; FK to feed(id) on delete cascade |
| started_at | timestamptz | Not null |
| completed_at | timestamptz | Nullable |
| status | feed_parse_status | Not null |
| failure_reason | text | Nullable; concise failure summary |
| http_status_code | smallint | Nullable |
| response_headers | jsonb | Not null; default '{}' |
| fetched_items_count | integer | Not null; default 0 |
| new_items_count | integer | Not null; default 0 |
| updated_items_count | integer | Not null; default 0 |
| skipped_items_count | integer | Not null; default 0 |
| created_at | timestamptz | Not null; default now() |

**feed_item**
| Column | Type | Constraints |
| --- | --- | --- |
| id | uuid | Primary key; UUIDv7 generated by application |
| feed_id | uuid | Not null; FK to feed(id) on delete cascade |
| fingerprint | char(64) | Not null |
| source_url | varchar(2048) | Not null |
| normalized_source_url | varchar(2048) | Not null |
| title | varchar(512) | Not null |
| summary | varchar(2048) | Nullable |
| published_at | timestamptz | Nullable |
| discovered_at | timestamptz | Not null; default now() |
| last_seen_at | timestamptz | Not null; default now() |
| first_parse_run_id | uuid | Nullable; FK to feed_parse_run(id) on delete set null |
| last_parse_run_id | uuid | Nullable; FK to feed_parse_run(id) on delete set null |
| raw_metadata | jsonb | Not null; default '{}' |
| created_at | timestamptz | Not null; default now() |
| updated_at | timestamptz | Not null; default now() |

**feed_parse_run_items**
| Column | Type | Constraints |
| --- | --- | --- |
| feed_parse_run_id | uuid | Not null; FK to feed_parse_run(id) on delete cascade |
| feed_item_id | uuid | Not null; FK to feed_item(id) on delete cascade |
| change_kind | feed_parse_item_change | Not null |
| seen_at | timestamptz | Not null; default now() |
Primary key (feed_parse_run_id, feed_item_id).

2. Relationships between tables
- AspNetUsers 1:N feed (ownership of feeds).
- AspNetUsers 1:N feed_analysis (draft analyses per user).
- feed_analysis (approved) 1:1 feed via feed.analysis_id and feed_analysis.approved_feed_id.
- feed 1:N feed_parse_run.
- feed 1:N feed_item.
- feed_parse_run N:M feed_item via feed_parse_run_items capturing items processed per run.
- feed_parse_run (discovery) 1:N feed_parse_run_items for created/updated membership records.

3. Indexes
- feed_analysis unique index on (user_id, normalized_url) to block duplicate analyses per target.
- feed_analysis btree index on (analysis_status, created_at desc) for workflow dashboards.
- feed unique index on (user_id, public_id) backing feed URL routing.
- feed unique index on (user_id, normalized_source_url) to prevent duplicate feeds on same site per user.
- feed btree index on (next_parse_after, status) to schedule background worker polling.
- feed_parse_run btree index on (feed_id, started_at desc) for recent history queries.
- feed_parse_run partial index on (status) where status = 'failed' for failure triage.
- feed_item unique index on (feed_id, normalized_source_url).
- feed_item unique index on (feed_id, fingerprint).
- feed_item btree index on (feed_id, published_at desc) for RSS ordering.
- feed_item btree index on (feed_id, last_seen_at desc) to detect stale items.
- feed_parse_run_items btree index on (feed_item_id, seen_at desc) to quickly locate latest run associations.
- feed_parse_run_items btree index on (feed_parse_run_id, change_kind) to summarize run outcomes.
- feed_parse_run gin index on metrics for diagnostic JSONB queries (optional, create if telemetry analytics queries emerge).

4. Additional notes or explanations about design decisions
- UUIDv7 values are generated by the application layer to preserve temporal ordering while staying globally unique; columns omit database defaults intentionally.
- Normalized URL columns must store canonicalized forms (lower-case host, trimmed paths, stripped fragments); application enforces normalization before persistence to keep unique constraints effective.
- updated_at timestamps can be maintained via application code or a shared trigger; choose one approach and apply consistently across tables.
- Standard ASP.NET Identity tables (AspNetRoles, AspNetUserRoles, AspNetUserClaims, etc.) remain unchanged and are omitted from detail; only AspNetUsers is referenced directly.
- jsonb columns (selectors, warnings, preflight_details, response_headers, metrics, raw_metadata) enable flexible schema evolution as AI-driven selectors and telemetry payloads evolve without requiring migrations.
- ttl_minutes enforces RSS TTL requirement (default 60) yet allows per-feed overrides within reasonable bounds; adjust check constraint if business rules expand.
- Additional check constraints or composite indexes can be introduced alongside query pattern discoveries during implementation without breaking current design.
